FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGNpY2QtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEgc2FtcGxl\
IEFQQiB0byBkZXBsb3kgYSBDSS9DRCBwcm9qZWN0CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0\
aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IENJL0NEIChBUEIpCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiBhbiBBUEIgdG8gZGVwbG95IGEgQ0kvQ0QgZW52aXJvbm1lbnQKcGxhbnM6CiAgLSBuYW1l\
OiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjaWNk\
LWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZh\
dWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogRGVmYXVsdCBwbGFuLCBwcm92aWRlcyBhIENJL0NE\
IGVudmlyb25tZW50CiAgICAgIGNvc3Q6ICQwLjAwIAogICAgcGFyYW1ldGVyczoKICAgICAgLSBu\
YW1lOiBhcHBfbmFtZQogICAgICAgIGRlZmF1bHQ6IG15YXBwCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IEFwcGxpY2F0aW9uIE5hbWUKICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAtIG5hbWU6IGJ1aWxkX25hbWVzcGFjZQogICAgICAgIGRlZmF1bHQ6IGFwYi10YXNrcy1i\
dWlsZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBCdWlsZCBwcm9qZWN0CiAg\
ICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiB0ZXN0X25hbWVzcGFjZQogICAgICAg\
IGRlZmF1bHQ6IGFwYi10YXNrcy10ZXN0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0\
bGU6IEFQQiBUYXNrcyB0ZXN0IHByb2plY3QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAt\
IG5hbWU6IHByb2RfbmFtZXNwYWNlCiAgICAgICAgZGVmYXVsdDogYXBiLXRhc2tzLXByb2QKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogQVBCIFRhc2tzIHByb2QgcHJvamVjdAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogYWRtaW5fdXNlcgogICAgICAgIGRl\
ZmF1bHQ6IG1heGltZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBTZWNvbmQg\
cHJvamVjdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogYWRtaW5fcGFzc3dv\
cmQKICAgICAgICBkZWZhdWx0OiAiIXJlZGhhdDEyMyMiCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgdGl0bGU6IFNlY29uZCBwcm9qZWN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
