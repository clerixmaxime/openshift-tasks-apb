FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGNpY2QtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEgc2FtcGxl\
IEFQQiB0byBkZXBsb3kgYSBDSS9DRCBwcm9qZWN0CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0\
aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IENJL0NEIChBUEIpCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiBhbiBBUEIgdG8gZGVwbG95IGEgQ0kvQ0QgZW52aXJvbm1lbnQKcGxhbnM6CiAgLSBuYW1l\
OiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjaWNk\
LWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZh\
dWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogRGVmYXVsdCBwbGFuLCBwcm92aWRlcyBhIENJL0NE\
IGVudmlyb25tZW50CiAgICAgIGNvc3Q6ICQwLjAwIAogICAgcGFyYW1ldGVyczoKICAgICAgLSBu\
YW1lOiBidWlsZF9uYW1lc3BhY2UKICAgICAgICBkZWZhdWx0OiBhcGItdGFza3MtYnVpbGQKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X2dyb3VwOiBQcm9qZWN0cyBTZXR1cAog\
ICAgICAgIHRpdGxlOiBCdWlsZCBwcm9qZWN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
LSBuYW1lOiB0ZXN0X25hbWVzcGFjZQogICAgICAgIGRlZmF1bHQ6IGFwYi10YXNrcy10ZXN0CiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV9ncm91cDogUHJvamVjdHMgU2V0dXAK\
ICAgICAgICB0aXRsZTogQVBCIFRhc2tzIHRlc3QgcHJvamVjdAogICAgICAgIHJlcXVpcmVkOiB0\
cnVlCiAgICAgIC0gbmFtZTogcHJvZF9uYW1lc3BhY2UKICAgICAgICBkZWZhdWx0OiBhcGItdGFz\
a3MtcHJvZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRpc3BsYXlfZ3JvdXA6IFByb2pl\
Y3RzIFNldHVwCiAgICAgICAgdGl0bGU6IEFQQiBUYXNrcyBwcm9kIHByb2plY3QKICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGdpdF9yZXBvCiAgICAgICAgZGVmYXVsdDogaHR0\
cHM6Ly9naXRodWIuY29tL2NsZXJpeG1heGltZS9vcGVuc2hpZnQtdGFza3MuZ2l0CiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV9ncm91cDogR2l0IFJlcG9zaXRvcnkKICAgICAg\
ICB0aXRsZTogR2l0IHJlcG9zaXRvcnkgb2YgdGhlIGFwcGxpY2F0aW9uCiAgICAgICAgcmVxdWly\
ZWQ6IGZhbHNlCiAgICAgIC0gbmFtZTogYWRtaW5fdXNlcgogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIGRpc3BsYXlfZ3JvdXA6IEFkbWluaXN0cmF0aXZlIFVzZXIKICAgICAgICB0aXRsZTog\
QWRtaW4gVXNlcgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogYWRtaW5fcGFz\
c3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X2dyb3VwOiBBZG1pbmlz\
dHJhdGl2ZSBVc2VyCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRpdGxl\
OiBBZG1pbiBQYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
