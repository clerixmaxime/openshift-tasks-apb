FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGNpY2QtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEgc2FtcGxl\
IEFQQiB0byBkZXBsb3kgYSBDSS9DRCBwcm9qZWN0CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0\
aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IENJL0NEIChBUEIpCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiBhbiBBUEIgdG8gZGVwbG95IGEgQ0kvQ0QgZW52aXJvbm1lbnQKcGxhbnM6CiAgLSBuYW1l\
OiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjaWNk\
LWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZh\
dWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogRGVmYXVsdCBwbGFuLCBwcm92aWRlcyBhIENJL0NE\
IGVudmlyb25tZW50CiAgICAgIGNvc3Q6ICQwLjAwIAogICAgcGFyYW1ldGVyczoKICAgICAgLSBu\
YW1lOiBidWlsZF9uYW1lc3BhY2UKICAgICAgICBkZWZhdWx0OiBhcGItdGFza3MtYnVpbGQKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogQnVpbGQgcHJvamVjdAogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdGVzdF9uYW1lc3BhY2UKICAgICAgICBkZWZhdWx0\
OiBhcGItdGFza3MtdGVzdAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBBUEIg\
VGFza3MgdGVzdCBwcm9qZWN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBw\
cm9kX25hbWVzcGFjZQogICAgICAgIGRlZmF1bHQ6IGFwYi10YXNrcy1wcm9kCiAgICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEFQQiBUYXNrcyBwcm9kIHByb2plY3QKICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGdpdF9yZXBvCiAgICAgICAgZGVmYXVsdDogaHR0\
cHM6Ly9naXRodWIuY29tL2NsZXJpeG1heGltZS9vcGVuc2hpZnQtdGFza3MuZ2l0CiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEdpdCByZXBvc2l0b3J5IG9mIHRoZSBhcHBsaWNh\
dGlvbgogICAgICAgIHJlcXVpcmVkOiBmYWxzZQogICAgICAtIG5hbWU6IGFkbWluX3VzZXIKICAg\
ICAgICBkZWZhdWx0OiBtYXhpbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTog\
U2Vjb25kIHByb2plY3QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGFkbWlu\
X3Bhc3N3b3JkCiAgICAgICAgZGVmYXVsdDogIiFyZWRoYXQxMjMjIgogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIHRpdGxlOiBTZWNvbmQgcHJvamVjdAogICAgICAgIHJlcXVpcmVkOiB0cnVl\
Cg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
